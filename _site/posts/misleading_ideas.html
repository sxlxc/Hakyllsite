<!doctype html>
<html lang="en">

<head>
    <link href="data:image/x-icon;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQEAYAAABPYyMiAAAABmJLR0T///////8JWPfcAAAACXBIWXMAAABIAAAASABGyWs+AAAAF0lEQVRIx2NgGAWjYBSMglEwCkbBSAcACBAAAeaR9cIAAAAASUVORK5CYII=" rel="icon" type="image/x-icon" />
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="googlebot" content="noindex">
    <title>"Gotchas" in Combinatorial Optimization</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/default.css" />
    <link rel="stylesheet" href="../css/pygentize.css" />
    <link rel="stylesheet" href="../css/chao-theorems.css">
    <script src="https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js"></script>
    <script>
        // page title
        document.addEventListener("DOMContentLoaded", function () {
            const hostname = window.location.hostname;
            document.title = document.title + " | " + hostname;
        });

        // pangu
        document.addEventListener('DOMContentLoaded', () => {
            pangu.autoSpacingPage();
        });

        // mathjax
        MathJax = {
            options: {
                menuOptions: {
                    settings: {
                        enrich: false,        // true to enable semantic-enrichment
                        collapsible: false,   // true to enable collapsible math
                        speech: false,        // true to enable speech generation
                        braille: false,       // true to enable Braille generation
                        assistiveMml: false,  // true to enable assistive MathML
                    }
                },
                enableMenu: false
            },
            output: {
                font: 'mathjax-fira',
                fontURL: '/mathjax-fira-font'
            },
            tex: {
                macros: {
                    floor: ["{\\left\\lfloor #1 \\right\\rfloor}", 1],
                    ceil: ["{\\left\\lceil #1 \\right\\rceil}", 1],
                    set: ["{\\left\\{ #1 \\right\\}}", 1],
                    norm: ["{\\left\\| #1 \\right\\|}", 1],
                    F: "{\\mathbb F}",
                    R: "{\\mathbb R}",
                    C: "{\\mathbb C}",
                    Z: "{\\mathbb Z}",
                    e: "{\\varepsilon}",
                    mex: "\\mathop{\\operatorname{mex}}",
                    lcm: "\\mathop{\\operatorname{lcm}}",
                    dist: "\\mathop{\\operatorname{dist}}",
                }
            }
        };
    </script>
    <script defer src="../mathjax/tex-chtml.js"></script>

</head>

<body>
    <div class="navbar-space">
        
        <!-- A table of contents on the left side, but only for screens
                that are big enough -->
        <div id="contents-big">
            <p class="mini-header">Contents <a id="up-arrow" href="#">â†‘</a></p>
            <ul>
<li><a href="#polytope-for-s-t-cut">Polytope for s-t cut</a></li>
<li><a href="#size-of-support">Size of support</a></li>
<li><a href="#cocircuit-space-of-binary-matroids">Cocircuit space of binary matroids</a></li>
</ul>
        </div>
        
    </div>
    <div class="text-space">
        <header class="no-print">
            <nav class="navbar">
                <a href="../">Home</a>
                <div class="navright">
                    <a href="../draft.html">Drafts</a>
                    <a href="../about.html">About</a>
                    <!-- <a href="/contact.html">Contact</a> -->
                    <!-- <a href="/archive.html">Archive</a> -->
                    <!-- <a href="/tags.html">Tags</a> -->
                </div>
            </nav>
        </header>

        <main role="main">
            <h1 class="pagetitle">"Gotchas" in Combinatorial Optimization</h1>
            <article>
    <section class="subtitle">
        
        
    </section>
    <section class="header">
        Posted on April 30, 2025
        
            by Yu Cong
        
    </section>
    <div class="info">
        
            Tags: <a title="All pages tagged 'optimization'." href="../tags/optimization.html" rel="tag">optimization</a>, <a title="All pages tagged 'alg'." href="../tags/alg.html" rel="tag">alg</a>
        
    </div>    
    <section>
        <p>It would be fun to have a list of misleading ideas and traps in CO. I
will update this post for new problems.</p>
<h1 data-number="1" id="polytope-for-s-t-cut"><span class="header-section-number">1</span> Polytope for s-t cut</h1>
<p><span class="math display">\[\begin{equation}
\begin{aligned}
\sum_{e\in p} x_e &amp;\geq 1   &amp;   &amp;\forall \text{ $s$-$t$ path
$p$}\\
              x_e &amp;\geq 0   &amp;   &amp;\forall e\in E
\end{aligned}
\end{equation}\]</span> Is this polytope integral?</p>
<p>Initially I thought, we have max flow min cut thm and flow polytope
is integral and this path formulation of s-t cut should be the dual of
flow problem and thus it is integral. However, hitting spanning tree
(dual to tree packing) formulation has a integrality gap of 2. Make
sense.</p>
<p>However, LP(1) is <strong>not</strong> <a href="https://en.wikipedia.org/wiki/Max-flow_min-cut_theorem#Linear_program_formulation">the
dual of Max-flow</a>.</p>
<h1 data-number="2" id="size-of-support"><span class="header-section-number">2</span> Size of support</h1>
<p>Given a linear program with a rank <span class="math inline">\(r\)</span> constraint matrix, what is the size of
support of its optimal solution?</p>
<p>This is mentioned in <a href="../posts/basepacking.html">a previous
post</a>. The description there is not precise. Consider the following
linear program,</p>
<p><span class="math display">\[\begin{equation*}
\begin{aligned}
\min&amp;   &amp;   c^Tx&amp;   \\
s.t.&amp;   &amp;   Ax&amp;\leq b\\
    &amp;   &amp;   x&amp;\geq 0
\end{aligned}
\end{equation*}\]</span></p>
<p>Let <span class="math inline">\(r\)</span> be the rank of <span class="math inline">\(A\)</span>. We may assume <span class="math inline">\(b\geq0\)</span>. For any <span class="math inline">\(c\)</span> that this LP has a bounded solution,
there must exist an optimal solution <span class="math inline">\(x^*\)</span> with support at most <span class="math inline">\(r\)</span>. There are at most <span class="math inline">\(r\)</span> tight constraints in <span class="math inline">\(Ax\leq b\)</span> and hence the optimal solution
<span class="math inline">\(x^*\)</span> lies in the intersection of
<span class="math inline">\(\R^n_+\)</span> and a rank <span class="math inline">\(\geq n-r\)</span> affine subspace, which is a
convex polyhedron. If the LP has a bounded solution, then the optimal
<span class="math inline">\(x^*\)</span> must be some vertex of the
polyhedron. To make a point in our affine subspace a vertex in the
polyhedron, we need at least <span class="math inline">\(n-r\)</span>
hyperplanes <span class="math inline">\(x_i=0\)</span>, each of the
hyperplanes gives us a zero coordinate. Thus for any bounded solution,
the support is at most <span class="math inline">\(r\)</span>.</p>
<p>What about integer programs? One may think that the support should
also be at most <span class="math inline">\(r\)</span>, since the 0s in
the optimal solution of its linear relaxation are integers. But rounding
the fractional coordinates may break the feasibility. The currently best
upperbound is roughly <span class="math inline">\(m
(3\|A\|_1+\sqrt{\log( \|A\|_1 )})\)</span> <span class="citation" data-cites="Berndt_Brinkop_Jansen_Mnich_Stamm_2023">[<a href="#ref-Berndt_Brinkop_Jansen_Mnich_Stamm_2023" role="doc-biblioref">1</a>]</span>.</p>
<h1 data-number="3" id="cocircuit-space-of-binary-matroids"><span class="header-section-number">3</span> Cocircuit space of binary
matroids</h1>
<p>This comes from the proof of Lemma 4.2 in <span class="citation" data-cites="geelen_computing_2018">[<a href="#ref-geelen_computing_2018" role="doc-biblioref">2</a>]</span>.</p>
<p>First, recall that we have the following property for binary
matroid.</p>
<div id="roweqcocycle" class="theorem-environment Proposition" data-index="1" type="Proposition" title="[@oxley_matroid_2011,Proposition 9.2.2]">
<span class="theorem-header"><span class="type">Proposition</span><span class="index">1</span><span class="name"><span class="citation" data-cites="oxley_matroid_2011">[<a href="#ref-oxley_matroid_2011" role="doc-biblioref">3</a>,Proposition 9.2.2]</span></span></span>
<p>Let <span class="math inline">\(A\)</span> be a binary representation
of a rank-<span class="math inline">\(r\)</span> binary matroid <span class="math inline">\(M\)</span>. Then the cocircuit space of <span class="math inline">\(M\)</span> equals the row space of <span class="math inline">\(A\)</span>. Moreover, this space has dimension
<span class="math inline">\(r\)</span> and is the orthogonal subspace of
the circuit space of <span class="math inline">\(M\)</span>.</p>
</div>
<p>To see this proposition, consider doing some row operations and
deleting zero rows to make the matrix <span class="math inline">\(A\)</span> become <span class="math inline">\([I_r| D]\)</span>. Note that row operations do not
change the row space. The set of the first <span class="math inline">\(r\)</span> columns is a base of <span class="math inline">\(M\)</span> and the set of the rest <span class="math inline">\(n-r\)</span> columns is a cobase. Denote this base
by <span class="math inline">\(B\)</span> and the cobase by <span class="math inline">\(B^*\)</span>. Now the support of each row is a
fundamental cociruit with respect to <span class="math inline">\(B^*\)</span>. To see this claim, we have several
approaches:</p>
<ol type="1">
<li>The dual matroids of <span class="math inline">\([I_r|D]\)</span> is
<span class="math inline">\([-D^T|I_{n-r}]\)</span>. Since we are
working with <span class="math inline">\(\F_2\)</span>, the dual is just
the binary matroid <span class="math inline">\([D^T|I_{n-r}]\)</span>.
The claim follows easily.</li>
<li>Take a row from <span class="math inline">\([I_r| D]\)</span> and
let <span class="math inline">\(F^*\)</span> be the set of columns with
value <span class="math inline">\(0\)</span>. One can easily see that
this is a hyperplane since the rank is <span class="math inline">\(r-1\)</span> and any column not in <span class="math inline">\(F^*\)</span> has <span class="math inline">\(1\)</span> in that row, thus adding any element in
<span class="math inline">\(E\setminus F^*\)</span> will increase the
rank. Then the complement of <span class="math inline">\(F^*\)</span> is
a cocircuit.</li>
</ol>
<p>The claim shows that the cocircuit space contains the row space. Now
we prove the other side. Every circuit is a fundamental circuit to some
base. Thus we can choose different cobase <span class="math inline">\(B^*\)</span> and do the same argument to show that
every circuit in the row space. Hence, the cocircuit space is the same
as row space of <span class="math inline">\(A\)</span>.</p>
<p>Here is the problem: Given a binary matroid <span class="math inline">\(A\in \F_2^{r\times n}\)</span> and a cocycle <span class="math inline">\(C^*\)</span> of <span class="math inline">\(A\)</span>, there exists a vector <span class="math inline">\(y\in \F_2^r\)</span> such that <span class="math inline">\(C^*\)</span> remains a cocycle in <span class="math inline">\(y^T A\)</span>.</p>
<p>With <a href="#roweqcocycle" title="Proposition 1">Proposition 1</a>,
you may think that this looks fine. The incidence vector of any cocycle
is in the row space and <span class="math inline">\(y^T A\)</span> is a
linear combination of row vectors.</p>
<p><strong>Counterexample</strong>: Consider the following binary
matroid.</p>
<span class="math display">\[\begin{bmatrix}
0 &amp; 0 &amp; 0 &amp; 1 &amp; 1&amp; 1&amp; 1 \\
0&amp; 1&amp;1&amp;0&amp;0&amp;1&amp;1\\
1&amp;0&amp;1&amp;0&amp;1&amp;0&amp;1\\
\end{bmatrix}\]</span>
<p>Any single column vector is a flat. So its complement should be a
cocycle. However, it is easy to see that <span class="math inline">\(\begin{bmatrix}
0 &amp; 1 &amp; 1 &amp; 1 &amp; 1&amp; 1&amp; 1
\end{bmatrix}\)</span> is not in the row space.</p>
<p>The bug is the definition of cocycle and cocircuit space. Cocycle is
union of cocircuits but things in cocircuit space is the symmetric
difference of cocircuits. (Or if you prefer to call the disjoint union
of circuits a cycle, the complement of flat is union of cocircuits not
cocycle.)</p>
<h1 class="unnumbered" id="bibliography">References</h1>
<div id="refs" class="references csl-bib-body" data-entry-spacing="0" role="list">
<div id="ref-Berndt_Brinkop_Jansen_Mnich_Stamm_2023" class="csl-entry" role="listitem">
<div class="csl-left-margin">[1] </div><div class="csl-right-inline">S.
Berndt, H. Brinkop, K. Jansen, M. Mnich, T. Stamm, New support size
bounds for integer programming, applied to makespan minimization on
uniformly related machines, in: <em>34th International Symposium on
Algorithms and Computation (ISAAC 2023)</em>, Schloss Dagstuhl â€“
Leibniz-Zentrum fÃ¼r Informatik, 2023: pp. 13:1â€“13:18 <a href="https://doi.org/10.4230/LIPIcs.ISAAC.2023.13">10.4230/LIPIcs.ISAAC.2023.13</a>.</div>
</div>
<div id="ref-geelen_computing_2018" class="csl-entry" role="listitem">
<div class="csl-left-margin">[2] </div><div class="csl-right-inline">J.
Geelen, R. Kapadia, Computing <span>Girth</span> and
<span>Cogirth</span> in <span>Perturbed</span> <span>Graphic</span>
<span>Matroids</span>, <em>Combinatorica</em>. 38 (2018) 167â€“191 <a href="https://doi.org/10.1007/s00493-016-3445-3">10.1007/s00493-016-3445-3</a>.</div>
</div>
<div id="ref-oxley_matroid_2011" class="csl-entry" role="listitem">
<div class="csl-left-margin">[3] </div><div class="csl-right-inline">J.G. Oxley, Matroid theory, 2nd ed, Oxford
University Press, Oxford ; New York, 2011.</div>
</div>
</div>
    </section>
</article>

        </main>

        <footer class="no-print">
            Site proudly generated by
            <a href="http://jaspervdj.be/hakyll">Hakyll</a>.
            <a href="https://github.com/congyu711/Hakyllsite">Source on Github</a>.
            License <a href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0 </a> <img src="https://licensebuttons.net/l/by-sa/4.0/88x31.png" alt="Creative Commons License" style="height: 12px; vertical-align: baseline;">

        </footer>
    </div>
</body>

</html>