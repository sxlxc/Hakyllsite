!function e(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n():"function"==typeof define&&define.amd?define("pangu",[],n):"object"==typeof exports?exports.pangu=n():t.pangu=n()}(window,function(){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t||4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,(function(t){return e[t]}).bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function t(){return e.default}:function t(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var a,i,o,r,c;function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,i=[],void 0!==(o="function"==typeof(a=c=function(){"use strict";function t(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function a(e,t){return(a=Object.setPrototypeOf||function e(t,n){return t.__proto__=n,t})(e,t)}function i(e){return(i=Object.setPrototypeOf?Object.getPrototypeOf:function e(t){return t.__proto__||Object.getPrototypeOf(t)})(e)}var o,r=function(e){!function e(t,n){if("function"!=typeof n&&null!==n)throw TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&a(t,n)}(f,e);var n,o,r,c,u,p=(n=f,o=function e(){if("undefined"==typeof Reflect||!Reflect.construct||Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function e(){var t,a,r,c=i(n);if(o){var u=i(this).constructor;r=Reflect.construct(c,arguments,u)}else r=c.apply(this,arguments);return t=this,a=r,a&&("object"===s(a)||"function"==typeof a)?a:function e(t){if(void 0===t)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)});function f(){var e;return function e(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")}(this,f),(e=p.call(this)).blockTags=/^(div|p|h1|h2|h3|h4|h5|h6)$/i,e.ignoredTags=/^(script|code|pre|textarea)$/i,e.presentationalTags=/^(b|code|del|em|i|s|strong|kbd)$/i,e.spaceLikeTags=/^(br|hr|i|img|pangu)$/i,e.spaceSensitiveTags=/^(a|del|pre|s|strike|u)$/i,e.isAutoSpacingPageExecuted=!1,e}return r=f,c=[{key:"isContentEditable",value:function e(t){return t.isContentEditable||t.getAttribute&&"true"===t.getAttribute("g_editable")}},{key:"isSpecificTag",value:function e(t,n){return t&&t.nodeName&&t.nodeName.search(n)>=0}},{key:"isInsideSpecificTag",value:function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=t;if(a&&this.isSpecificTag(i,n))return!0;for(;i.parentNode;)if(i=i.parentNode,this.isSpecificTag(i,n))return!0;return!1}},{key:"canIgnoreNode",value:function e(t){var n=t;if(n&&(this.isSpecificTag(n,this.ignoredTags)||this.isContentEditable(n)))return!0;for(;n.parentNode;)if((n=n.parentNode)&&(this.isSpecificTag(n,this.ignoredTags)||this.isContentEditable(n)))return!0;return!1}},{key:"isFirstTextChild",value:function e(t,n){for(var a=t.childNodes,i=0;i<a.length;i++){var o=a[i];if(o.nodeType!==Node.COMMENT_NODE&&o.textContent)return o===n}return!1}},{key:"isLastTextChild",value:function e(t,n){for(var a=t.childNodes,i=a.length-1;i>-1;i--){var o=a[i];if(o.nodeType!==Node.COMMENT_NODE&&o.textContent)return o===n}return!1}},{key:"spacingNodeByXPath",value:function e(t,n){if(!(!(n instanceof Node)||n instanceof DocumentFragment))for(var a,i,o=document.evaluate(t,n,null,XPathResult.ORDERED_NODE_SNAPSHOT_TYPE,null),r=o.snapshotLength-1;r>-1;--r){if(a=o.snapshotItem(r),this.isSpecificTag(a.parentNode,this.presentationalTags)&&!this.isInsideSpecificTag(a.parentNode,this.ignoredTags)){var c=a.parentNode;if(c.previousSibling){var s=c.previousSibling;if(s.nodeType===Node.TEXT_NODE){var u=s.data.substr(-1)+a.data.toString().charAt(0),p=this.spacing(u);u!==p&&(s.data="".concat(s.data," "))}}if(c.nextSibling){var f=c.nextSibling;if(f.nodeType===Node.TEXT_NODE){var l=a.data.substr(-1)+f.data.toString().charAt(0),d=this.spacing(l);l!==d&&(f.data=" ".concat(f.data))}}}if(this.canIgnoreNode(a)){i=a;continue}var g=this.spacing(a.data);if(a.data!==g&&(a.data=g),i){if(a.nextSibling&&a.nextSibling.nodeName.search(this.spaceLikeTags)>=0){i=a;continue}var h=a.data.toString().substr(-1)+i.data.toString().substr(0,1);if(this.spacing(h)!==h){for(var y=i;y.parentNode&&-1===y.nodeName.search(this.spaceSensitiveTags)&&this.isFirstTextChild(y.parentNode,y);)y=y.parentNode;for(var v=a;v.parentNode&&-1===v.nodeName.search(this.spaceSensitiveTags)&&this.isLastTextChild(v.parentNode,v);)v=v.parentNode;if(v.nextSibling&&v.nextSibling.nodeName.search(this.spaceLikeTags)>=0){i=a;continue}if(-1===v.nodeName.search(this.blockTags)){if(-1===y.nodeName.search(this.spaceSensitiveTags))-1!==y.nodeName.search(this.ignoredTags)||-1!==y.nodeName.search(this.blockTags)||(i.previousSibling?-1===i.previousSibling.nodeName.search(this.spaceLikeTags)&&(i.data=" ".concat(i.data)):this.canIgnoreNode(i)||(i.data=" ".concat(i.data)));else if(-1===v.nodeName.search(this.spaceSensitiveTags))a.data="".concat(a.data," ");else{var $=document.createElement("pangu");$.innerHTML=" ",y.previousSibling?-1===y.previousSibling.nodeName.search(this.spaceLikeTags)&&y.parentNode.insertBefore($,y):y.parentNode.insertBefore($,y),!$.previousElementSibling&&$.parentNode&&$.parentNode.removeChild($)}}}}i=a}}},{key:"spacingNode",value:function e(t){var n=".//*/text()[normalize-space(.)]";t.children&&0===t.children.length&&(n=".//text()[normalize-space(.)]"),this.spacingNodeByXPath(n,t)}},{key:"spacingElementById",value:function e(t){var n='id("'.concat(t,'")//text()');this.spacingNodeByXPath(n,document)}},{key:"spacingElementByClassName",value:function e(t){var n='//*[contains(concat(" ", normalize-space(@class), " "), "'.concat(t,'")]//text()');this.spacingNodeByXPath(n,document)}},{key:"spacingElementByTagName",value:function e(t){var n="//".concat(t,"//text()");this.spacingNodeByXPath(n,document)}},{key:"spacingPageTitle",value:function e(){this.spacingNodeByXPath("/html/head/title/text()",document)}},{key:"spacingPageBody",value:function e(){var t="/html/body//*/text()[normalize-space(.)]";["script","style","textarea"].forEach(function(e){t="".concat(t,'[translate(name(..),"ABCDEFGHIJKLMNOPQRSTUVWXYZ","abcdefghijklmnopqrstuvwxyz")!="').concat(e,'"]')}),this.spacingNodeByXPath(t,document)}},{key:"spacingPage",value:function e(){this.spacingPageTitle(),this.spacingPageBody()}},{key:"autoSpacingPage",value:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1e3,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:2e3;if(document.body instanceof Node&&!this.isAutoSpacingPageExecuted){this.isAutoSpacingPageExecuted=!0;var i=this,o=function e(t){var n=arguments,a=this,i=!1;return function(){!i&&(i=!0,t.apply(a,n))}}(function(){i.spacingPage()}),r=document.getElementsByTagName("video");if(0===r.length)setTimeout(function(){o()},t);else for(var c=0;c<r.length;c++){var s=r[c];if(4===s.readyState){setTimeout(function(){o()},3e3);break}s.addEventListener("loadeddata",function(){setTimeout(function(){o()},4e3)})}var u=[],p=function e(t,n,a){var i=arguments,o=this,r=null,c=null;return function(){var e=o,s=i,u=+new Date;clearTimeout(r),c||(c=u),u-c>=a?(t.apply(e,s),c=u):r=setTimeout(function(){t.apply(e,s)},n)}}(function(){for(;u.length;){var e=u.shift();e&&i.spacingNode(e)}},n,{maxWait:a});new MutationObserver(function(e,t){e.forEach(function(e){switch(e.type){case"childList":e.addedNodes.forEach(function(e){e.nodeType===Node.ELEMENT_NODE?u.push(e):e.nodeType===Node.TEXT_NODE&&u.push(e.parentNode)});break;case"characterData":var t=e.target;t.nodeType===Node.TEXT_NODE&&u.push(t.parentNode)}}),p()}).observe(document.body,{characterData:!0,childList:!0,subtree:!0})}}}],t(r.prototype,c),u&&t(r,u),f}(n(1).Pangu),c=new r;e.exports=c,e.exports.default=c,e.exports.Pangu=r})?a.apply(t,i):a)&&(e.exports=o)},function(e,t,n){var a,i,o,r,c;"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self&&self,i=[],void 0!==(o="function"==typeof(a=c=function(){"use strict";function t(e){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function e(t){return typeof t}:function e(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(e)}function n(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}var a="⺀-⻿⼀-⿟぀-ゟ゠-ヺー-ヿ㄀-ㄯ㈀-㋿㐀-䶿一-鿿豈-﫿",i=RegExp("[".concat(a,"]")),o="`~!@#$%*^&()/\\-+=<>?:\"{}|,.;'[\\]\xb7~￥%——|\\\\",r="`~!@#$%^&()/\\-+=<>?:\"{}|,.;'[\\]\xb7~￥%——|\\\\",c="`~!#$%^&/+=<>?:\"|,;'\xb7~￥%——|\\\\",s=RegExp("([A-Za-z_])([".concat(a,"]+)"),"g"),u=RegExp("([".concat(a,"]+)([A-Za-z_])"),"g"),p=RegExp("([0-9_])([".concat(a,"]+)"),"g"),f=RegExp("([".concat(a,"]+)([0-9_])"),"g"),l=RegExp("([".concat(a,"]+)(&)([A-Za-z_])"),"g"),d=RegExp("([A-Za-z_])(&)([".concat(a,"]+)"),"g"),g=RegExp("([A-Za-z_])([".concat("`~!@#$%^&)/\\-+=<>?:\"}|,.;'\\]\xb7~￥%——|\\\\","])([").concat(a,"])"),"g"),h=RegExp("([".concat(a,"])([").concat("`~!@#$%^&(/\\-+=<>?:\"{|,.;'[\xb7~￥%——|\\\\","])([A-Za-z_])"),"g"),y=RegExp("([0-9_])([".concat(r,"])([").concat(a,"])"),"g"),v=RegExp("([".concat(a,"])([").concat(r,"])([0-9_])"),"g"),$=RegExp("([".concat(a,"])([<\\[{\\(])"),"g"),b=RegExp("([>\\]\\)}])([".concat(a,"])"),"g"),N=RegExp("([A-Za-z_])([0-9_])([".concat(a,"])"),"g"),T=RegExp("([".concat(a,"])([").concat(o,"])([").concat(o,"])"),"g"),_=RegExp("([".concat(o,"])([").concat(o,"])([").concat(a,"])"),"g"),m=RegExp("([".concat(a,"])([").concat(c,"])([").concat(a,"])([").concat(c,"])([").concat(a,"])"),"g"),x=RegExp("([".concat(a,"])([").concat(c,"])([").concat(a,"])"),"g"),S=RegExp("([".concat(a,"])(\\s*)(@[A-za-z0-9_]*)(\\s*)([").concat(a,"]+)(\\s*)([A-za-z0-9_]+)(\\s*)([").concat(a,"])")),E=function(){var e,a,o;function r(){(function e(t,n){if(!(t instanceof n))throw TypeError("Cannot call a class as a function")})(this,r),this.version="1.0.0"}return e=r,a=[{key:"spacing",value:function e(n){if("string"!=typeof n)return console.warn("spacing(text) only accepts string but got ".concat(t(n))),n;if(n.length<=1||!i.test(n))return n;var a=n;return(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=(a=a.replace(N,"$1$2 $3")).replace(s,"$1 $2")).replace(u,"$1 $2")).replace(p,"$1 $2")).replace(f,"$1 $2")).replace(l,"$1 $2 $3")).replace(d,"$1 $2 $3")).replace(g,"$1$2 $3")).replace(h,"$1 $2$3")).replace(y,"$1$2 $3")).replace(v,"$1 $2$3")).replace(T,"$1 $2$3")).replace(_,"$1$2 $3")).replace(b,"$1 $2")).replace($,"$1 $2")).replace(m,"$1 $2 $3 $4 $5")).replace(x,"$1 $2 $3")).replace(S,"$1 $3$5$7 $9")}},{key:"spacingText",value:function e(t){var n,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};try{n=this.spacing(t)}catch(i){a(i);return}a(null,n)}},{key:"spacingTextSync",value:function e(t){return this.spacing(t)}}],n(e.prototype,a),o&&n(e,o),r}(),P=new E;e.exports=P,e.exports.default=P,e.exports.Pangu=E})?a.apply(t,i):a)&&(e.exports=o)}])});